# Configuration Apache pour Laravel - BiblioTech Codespace
<VirtualHost *:80>
    # Répertoire racine Laravel
    DocumentRoot /workspace/public
    
    # Configuration du répertoire
    <Directory /workspace/public>
        # Permissions pour Laravel
        AllowOverride All
        Require all granted
        
        # Activer les réécritures d'URL
        Options Indexes FollowSymLinks
        
        # Configuration pour les routes Laravel
        DirectoryIndex index.php
        
        # Gestion des erreurs 404 par Laravel
        FallbackResource /index.php
    </Directory>

    # Configuration des logs pour le développement
    ErrorLog ${APACHE_LOG_DIR}/bibliotech_error.log
    CustomLog ${APACHE_LOG_DIR}/bibliotech_access.log combined
    LogLevel warn

    # Configuration PHP pour Laravel
    <FilesMatch \.php$>
        SetHandler application/x-httpd-php
    </FilesMatch>

    # Sécurité - Cacher les fichiers sensibles
    <Files ".env">
        Require all denied
    </Files>
    
    <Files "composer.json">
        Require all denied
    </Files>
    
    <Files "composer.lock">
        Require all denied
    </Files>

    # Configuration pour les assets Laravel
    <LocationMatch "\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$">
        ExpiresActive On
        ExpiresDefault "access plus 1 month"
        Header append Cache-Control "public"
    </LocationMatch>

    # Support pour les WebSockets (séances futures)
    # ProxyPreserveHost On
    # ProxyRequests Off
    # ProxyPass /socket.io/ http://localhost:6001/socket.io/
    # ProxyPassReverse /socket.io/ http://localhost:6001/socket.io/

    # Configuration spécifique au développement
    SetEnv APP_ENV development
    SetEnv APP_DEBUG true
</VirtualHost>

# Configuration globale pour le développement
# Désactiver la signature du serveur
ServerTokens Prod
ServerSignature Off

# Configuration pour les gros uploads (séances futures)
LimitRequestBody 104857600  # 100MB